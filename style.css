/* Apply Inter font globally for a clean look */
body {
    font-family: 'Inter', sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f0f4f8; /* Light background color */
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transition */
    font-size: 16px; /* Adjusted base font size for better readability */
}

/* Ensure HTML and Body take full height */
html {
    min-height: 100vh;
}

/* Dark Mode Styles */
body.dark-mode {
    background-color: #1a202c; /* Dark background */
    color: #e2e8f0; /* Light text (white-grayish) */
}
body.dark-mode #appContainer {
    background-color: #1a202c; /* Ensure app container matches body */
}
body.dark-mode .header {
    background-color: #2d3748; /* Darker header */
    border-bottom-color: #4a5568;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.4); /* Darker shadow for contrast */
}
body.dark-mode .back-button, body.dark-mode .home-button {
    background-color: #4a5568;
    color: #e2e8f0; /* Light text for icons */
}
body.dark-mode .back-button:hover, body.dark-mode .home-button:hover {
    background-color: #6366f1; /* Darker blue on hover */
}
/* Removed .time-left styles as the timer is removed */
body.dark-mode .home-container h1 {
    color: #e2e8f0; /* Changed to white-grayish for consistency */
}
body.dark-mode .home-container .website-name,
body.dark-mode .subject-selection h3,
body.dark-mode .test-mode-modal-content h3,
body.dark-mode .pre-submit-review-container h2,
body.dark-mode .pre-submit-review-container .section-title,
body.dark-mode .summary-container h2,
body.dark-mode .summary-container .section-title,
body.dark-mode .summary-container .summary-section h3,
body.dark-mode .question-number,
body.dark-mode .options-list label,
body.dark-mode .summary-question-item span,
body.dark-mode .summary-question-item-full .question-text-full,
body.dark-mode .message-modal-content p, /* Updated */
body.dark-mode .unified-ai-modal-content h3,
body.dark-mode .chat-message,
body.dark-mode .notes-interface-container h2, /* Notes interface header */
body.dark-mode .notes-interface-container h3, /* Notes interface tab titles */
body.dark-mode .notes-tab-button, /* Notes tab buttons */
body.dark-mode .checklist-item .item-text, /* Checklist item text */
body.dark-mode .add-item-container input::placeholder, /* Notes input placeholder */
body.dark-mode .flashcards-interface-container h2, /* Flashcards interface header */
body.dark-mode .flashcard-front, /* Flashcard front text */
body.dark-mode .flashcard-back, /* Flashcard back text */
body.dark-mode .flashcard-folder-item, /* New: folder item text */
body.dark-mode .flashcard-set-item /* New: set item text */
{
    color: #e2e8f0; /* General light text for dark mode */
}
body.dark-mode .subject-selection,
body.dark-mode .test-container,
body.dark-mode .pre-submit-review-container,
body.dark-mode .summary-container,
body.dark-mode .question-block,
body.dark-mode .sidebar,
body.dark-mode .subject-item,
body.dark-mode .test-progress-footer,
body.dark-mode .message-modal-content, /* Updated */
body.dark-mode .unified-ai-modal-content,
body.dark-mode .chat-input-container-new,
body.dark-mode .chat-messages, /* Ensure chat messages background is dark */
body.dark-mode .notes-interface-container, /* Notes interface container */
body.dark-mode .notes-tab-pane, /* Notes tab panes */
body.dark-mode .add-item-container input, /* Notes input field */
body.dark-mode .flashcards-interface-container, /* Flashcards interface container */
body.dark-mode .flashcard-card, /* Flashcard card */
body.dark-mode .flashcard-folder-item, /* New: folder item background */
body.dark-mode .flashcard-set-item /* New: set item background */
{
    background-color: #2d3748; /* Darker backgrounds for main sections and modals */
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4); /* Stronger shadow */
    border-color: #4a5568; /* Darker borders */
}
body.dark-mode .subject-item {
    background-color: #4a5568; /* Default subject item in dark mode */
    border-color: #6366f1;
}
body.dark-mode .subject-item.active-subject {
    background-color: #4338ca; /* Darker blue for active subject in dark mode */
    border-color: #6366f1;
    color: #e0f2fe;
}
body.dark-mode .subject-item:hover {
    background-color: #4f46e5; /* Darker blue on hover */
}
body.dark-mode .test-mode-modal-content .test-mode-option label {
    background-color: #4a5568; /* Dark background for options */
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .test-mode-modal-content .test-mode-option label:hover {
    background-color: #6366f1;
    border-color: #818cf8;
}
body.dark-mode .test-mode-modal-content .test-mode-option input[type="radio"]:checked + span {
    color: #e0f2fe; /* Specific highlight color, not general text */
}
body.dark-mode .test-mode-modal-content .test-mode-option input[type="radio"]:checked ~ label {
    background-color: #4338ca;
    border-color: #6366f1;
}
body.dark-mode .test-mode-separator {
    border-bottom-color: #4a5568;
}
body.dark-mode .sidebar {
    background-color: #2d3748; /* Darker sidebar background */
    border-right-color: #4a5568;
}
body.dark-mode .sidebar-question-item {
    background-color: #4a5568; /* Dark background for sidebar items */
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .sidebar-question-item:hover {
    background-color: #6366f1;
    border-color: #818cf8;
}
body.dark-mode .sidebar-question-item.answered {
    background-color: #14532d; /* Darker green */
    border-color: #22c55e;
}
body.dark-mode .sidebar-question-item.flagged {
    background-color: #854d09;
    border-color: #facc15;
}
body.dark-mode .sidebar-question-item.active {
    background-color: #4338ca;
    border-color: #6366f1;
}
body.dark-mode .flag-icon {
    filter: brightness(0) invert(1); /* Keep white/light gray in dark mode */
}
body.dark-mode .flag-icon.flagged {
    filter: none; /* Show original red SVG in dark mode */
}

body.dark-mode .options-list label:hover {
    color: #cbd5e0; /* Lighter hover for text */
}
body.dark-mode .options-list input[type="radio"] {
    accent-color: #6366f1;
}
body.dark-mode .options-list label.correct-option-highlight {
    background-color: #14532d;
    border-color: #22c55e;
    color: #e0f2fe; /* Ensure text is light */
}
body.dark-mode .options-list label.incorrect-chosen-highlight {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2; /* Ensure text is light */
}
body.dark-mode .immediate-explanation-box {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2;
}
body.dark-mode .immediate-explanation-box strong {
    color: #fca5a5;
}
body.dark-mode .ai-explanation-container {
    background-color: #064e3b;
    border: 1px solid #34d399; /* Teal border */
    color: #a7f3d0; /* Light teal text */
}
body.dark-mode .ai-explanation-container strong {
    color: #047857;
}
body.dark-mode .ai-explanation-container .loader {
    border-top-color: #6ee7b7;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
body.dark-mode .review-question-item .review-link,
body.dark-mode .summary-question-item .review-link {
    color: #93c5fd;
}
body.dark-mode .summary-score {
    color: #22c55e;
}
body.dark-mode .status-badge.answered,
body.dark-mode .status-badge.correct {
    background-color: #14532d;
    color: #22c55e;
}
.status-badge.unanswered {
    background-color: transparent; /* No background highlight */
    color: #718096; /* Darker grey text */
    border: 1px solid #718096; /* Add a subtle border to define its area */
}
body.dark-mode .status-badge.unanswered {
    background-color: transparent; /* No background highlight */
    color: #a0aec0; /* Lighter grey text for dark mode */
    border: 1px solid #a0aec0; /* Subtle border for dark mode */
}
body.dark-mode .status-badge.incorrect {
    background-color: #7f1d1d;
    color: #ef4444;
}
body.dark-mode .status-badge.flagged {
    background-color: #854d09;
    color: #facc15;
}
body.dark-mode .summary-question-item-full {
    background-color: #4a5568;
    border-color: #6366f1;
}
body.dark-mode .summary-question-item-full .option-review { /* NEW: Ensure options within full review are dark */
    background-color: #2d3748; /* Darker background for options */
    color: #e2e8f0; /* White-grayish text */
    border: 1px solid #4a5568; /* Subtle border */
}
body.dark-mode .summary-question-item-full .option-review.correct-option {
    background-color: #14532d;
    border-color: #22c55e;
    color: #e0f2fe;
}
body.dark-mode .summary-question-item-full .option-review.user-chosen-incorrect {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2;
}
body.dark-mode .summary-question-item-full .explanation-box {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2;
}
body.dark-mode .summary-question-item-full .explanation-box strong {
    color: #fca5a5;
}
body.dark-mode .test-progress-footer {
    background-color: #2d3748;
    border-top: 1px solid #4a5568;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.4);
}
body.dark-mode .progress-box {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .progress-box.answered {
    background-color: #4338ca;
    border-color: #6366f1;
    color: #e0f2fe;
}
body.dark-mode .progress-box:hover {
    background-color: #6366f1;
}
/* Confirmation Modal for dark mode */
body.dark-mode .message-modal-content { /* Updated */
    background-color: #2d3748;
    color: #e2e8f0;
}
body.dark-mode .message-modal-content p { /* Updated */
    color: #e2e8f0;
}
body.dark-mode .message-modal-buttons .btn-no { /* Updated */
    background-color: #4a5568;
    color: #e2e8f0;
}
body.dark-mode .message-modal-buttons .btn-no:hover { /* Updated */
    background-color: #6366f1;
}
/* Corrected shadow for submit button */
body.dark-mode .submit-button,
body.dark-mode .confirm-submit-button, /* Corrected shadow here */
body.dark-mode .action-button-summary,
body.dark-mode .unified-ai-tab-button,
body.dark-mode .notes-interface-button, /* Notes interface button */
body.dark-mode .save-notes-button, /* Save notes button */
body.dark-mode .add-item-button, /* Add item button */
body.dark-mode .flashcards-interface-button, /* Flashcards button */
body.dark-mode .flashcard-action-button, /* Flashcard action buttons */
body.dark-mode .flashcard-nav-button /* Flashcard navigation buttons */
{
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3); /* Darker shadows for buttons */
}
body.dark-mode .message-modal-buttons .btn-yes { /* Updated */
    box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
}
body.dark-mode .message-modal-buttons .btn-no { /* Updated */
    box-shadow: 0 4px 10px rgba(128, 128, 128, 0.3); /* Grayish shadow for no button */
}
body.dark-mode .chat-message.user {
    background-color: #4338ca; /* User message background */
    color: #e0f2fe;
}
body.dark-mode .chat-message.ai {
    background-color: #4a5568;
    color: #e2e8f0;
}
body.dark-mode .chat-input {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .chat-input:focus {
    border-color: #4f46e5;
}
body.dark-mode .chat-input::placeholder {
    color: #a0aec0;
}
.icon-button {
    background-color: transparent;
    border: none;
    padding: 0.5rem;
    cursor: pointer;
    color: #4a5568;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease, color 0.2s ease;
}
.icon-button:hover {
    background-color: #e2e8f0;
}
body.dark-mode .icon-button {
    color: #a0aec0;
}
body.dark-mode .icon-button:hover {
    background-color: #4a5568;
}


/* Main app container to hold all pages */
#appContainer {
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    width: 100%;
    transition: background-color 0.3s ease;
}

/* Header styles (now part of appContainer, shown conditionally) */
.header {
    background-color: #ffffff;
    padding: 1rem 2rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-bottom: 1px solid #e2e8f0;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    width: 100%; /* Ensure header spans full width */
    box-sizing: border-box; /* Include padding in width */
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    position: relative; /* Added for z-index to work */
    z-index: 100; /* Ensure header is on top */
}

.header-buttons {
    display: flex;
    gap: 0.5rem; /* Space between back and home buttons */
    align-items: center;
}

.back-button, .home-button {
    background-color: #4a5568; /* Dark gray */
    color: white;
    padding: 0.5rem; /* Smaller padding for icon buttons */
    border-radius: 0.5rem;
    font-weight: 500;
    transition: background-color 0.2s ease;
    cursor: pointer;
    border: none;
    width: 40px; /* Fixed width for icon buttons */
    height: 40px; /* Fixed height for icon buttons */
    display: flex;
    justify-content: center;
    align-items: center;
}
.back-button:hover, .home-button:hover {
    background-color: #2d3748; /* Darker gray on hover */
}
.back-button svg, .home-button svg {
    width: 24px; /* Size for SVG icons */
    height: 24px;
    fill: currentColor; /* Use button's text color for SVG fill */
}

/* Removed .time-left styles */

/* Main container for the entire test */
.test-container {
    display: flex;
    flex-grow: 1; /* Allow container to take available height */
    margin: 1rem auto; /* Added auto for horizontal centering */
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    overflow: hidden; /* For rounded corners on inner elements */
    position: relative; /* For footer positioning */
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    max-width: 1000px; /* Limit max-width for better appearance on large screens */
}

/* Left sidebar for question navigation */
.sidebar {
    width: 250px; /* Fixed width for sidebar */
    background-color: #f8fafc; /* Lighter background for sidebar */
    border-right: 1px solid #e2e8f0;
    padding: 1.5rem;
    overflow-y: auto; /* Scrollable if many questions */
    transition: background-color 0.3s ease, border-color 0.3s ease;
}
.sidebar-question-item {
    padding: 0.75rem 1rem;
    margin-bottom: 0.5rem;
    border-radius: 0.5rem;
    background-color: #ffffff;
    border: 1px solid #cbd5e0;
    cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.3s ease;
    font-size: 0.95rem; /* Slightly increased */
    font-weight: 500;
    color: #4a5568;
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.sidebar-question-item:hover {
    background-color: #edf2f7;
    border-color: #a0aec0;
}
body.dark-mode .sidebar-question-item {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .sidebar-question-item:hover {
    background-color: #6366f1;
    border-color: #818cf8;
}
body.dark-mode .sidebar-question-item.answered {
    background-color: #14532d; /* Light green for answered */
    border-color: #34d399;
}
body.dark-mode .sidebar-question-item.flagged {
    background-color: #854d09; /* Light yellow for flagged */
    border-color: #f6e05e;
}
body.dark-mode .sidebar-question-item.active {
    background-color: #4338ca;
    border-color: #6366f1;
}
.sidebar-question-status {
    font-size: 0.85rem; /* Slightly increased */
    color: #718096;
    transition: color 0.3s ease;
}

/* Main content area for questions */
.main-content {
    flex-grow: 1;
    padding: 2rem;
    overflow-y: auto; /* Scrollable if many questions */
    padding-bottom: 80px; /* Space for fixed footer */
}

/* Individual question block styles */
.question-block {
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}
.question-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px dashed #e2e8f0;
    transition: border-color 0.3s ease;
}
.question-number {
    font-size: 1.3rem; /* Slightly increased */
    font-weight: 700;
    color: #2d3748;
    transition: color 0.3s ease;
}
/* Flag icon styles - Adjusted size and filter for SVG */
.flag-icon {
    cursor: pointer;
    width: 20px; /* Set explicit width for the SVG image */
    height: 20px; /* Set explicit height for the SVG image */
    transition: filter 0.3s ease;
    filter: brightness(0) invert(1); /* Make default SVG white/light gray */
}
.flag-icon.flagged {
    filter: none; /* Show original red SVG when flagged */
}
body.dark-mode .flag-icon {
    filter: brightness(0) invert(1); /* Keep white/light gray in dark mode */
}
body.dark-mode .flag-icon.flagged {
    filter: none; /* Show original red SVG in dark mode */
}
.question-text {
    font-size: 1.1rem;
    line-height: 1.6;
    color: #2d3748;
    margin-bottom: 1.5rem;
    transition: color 0.3s ease;
}
/* NEW: Options list as a grid */
.options-list {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 0.75rem;
}
.options-list label {
    display: flex;
    align-items: center;
    padding: 0.5rem;
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    font-size: 1.05rem;
    color: #4a5568;
    cursor: pointer;
    transition: all 0.2s ease;
}
body.dark-mode .options-list label {
    border-color: #4a5568;
}
.options-list label:hover {
    background-color: #f7fafc;
    border-color: #cbd5e0;
}
body.dark-mode .options-list label:hover {
    background-color: #4a5568;
    border-color: #6366f1;
}
.options-list input[type="radio"] {
    margin-right: 0.75rem;
    transform: scale(1.2);
    accent-color: #4f46e5;
}
/* Styles for immediate feedback in "Right After" mode */
.options-list label.correct-option-highlight {
    background-color: #d1fae5;
    border-color: #34d399;
}
.options-list label.incorrect-chosen-highlight {
    background-color: #fee2e2;
    border-color: #fca5a5;
}
.immediate-explanation-box {
    background-color: #fef2f2;
    border: 1px solid #fca5a5;
    padding: 0.75rem;
    border-radius: 0.5rem;
    margin-top: 1rem;
    font-size: 0.95rem;
    color: #b91c1c;
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
.immediate-explanation-box strong {
    color: #7f1d1d;
    transition: color 0.3s ease;
}


/* Submit Button (for main test page) */
.submit-button {
    background-color: #10b981; /* Green */
    color: white;
    padding: 0.8rem 2rem;
    border-radius: 0.75rem;
    font-weight: 600;
    transition: background-color 0.2s ease, transform 0.2s ease;
    cursor: pointer;
    border: none;
    margin-top: 2rem;
    box-shadow: 0 4px 10px rgba(16, 185, 129, 0.3);
}
.submit-button:hover {
    background-color: #059669; /* Darker green */
    transform: translateY(-2px);
}
.submit-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(16, 185, 129, 0.3);
}

/* Pre-Submit Review Page Styles */
.pre-submit-review-container, .summary-container {
    flex-grow: 1;
    margin: 1rem auto; /* Added auto for horizontal centering */
    padding: 2rem;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    display: none; /* Hidden by default */
    flex-direction: column;
    align-items: center; /* Changed from flex-start to center */
    text-align: left; /* Align text within sections to left */
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    max-width: 1000px; /* Limit max-width for better appearance on large screens */
}
.pre-submit-review-container h2, .summary-container h2 {
    font-size: 2.6rem; /* Slightly increased */
    font-weight: 800;
    color: #2d3748;
    margin-bottom: 1.5rem;
    transition: color 0.3s ease;
    align-self: center; /* Changed from flex-start to center */
}
.pre-submit-review-container .section-title, .summary-container .section-title {
    font-size: 1.9rem; /* Slightly increased */
    font-weight: 700;
    color: #4a5568;
    margin-bottom: 1.5rem;
    transition: color 0.3s ease;
    align-self: center; /* Changed from flex-start to center */
}
.pre-submit-review-container .review-section, .summary-container .summary-section {
    width: 100%;
    max-width: 700px;
    margin-bottom: 1.5rem;
    padding: 1.5rem;
    background-color: #f8fafc;
    border-radius: 0.75rem;
    border: 1px solid #e2e8f0;
    text-align: left;
    transition: background-color 0.3s ease, border-color 0.3s ease;
}
body.dark-mode .pre-submit-review-container .review-section,
body.dark-mode .summary-container .summary-section {
    background-color: #2d3748; /* Darker background for review sections */
    border-color: #4a5568;
}
body.dark-mode .pre-submit-review-container .review-section h3,
body.dark-mode .summary-container .summary-section h3 {
    font-size: 1.6rem; /* Slightly increased */
    font-weight: 700;
    color: #e2e8f0; /* White-grayish text */
    margin-bottom: 1rem;
    border-bottom: 1px dashed #cbd5e0;
    padding-bottom: 0.5rem;
    transition: color 0.3s ease, border-color 0.3s ease;
}
body.dark-mode .pre-submit-review-container .review-section h3 {
    border-bottom-color: #4a5568;
}

/* NEW Table-like structure for review lists */
.review-table-container {
    width: 100%;
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    overflow: hidden; /* Ensures rounded corners */
    margin-bottom: 1rem;
}
body.dark-mode .review-table-container {
    border-color: #4a5568;
}

.review-table-header, .review-table-row {
    display: grid;
    /* Updated grid-template-columns for better spacing and Question Text clarity */
    grid-template-columns: 0.5fr 3.5fr 1.5fr; /* Question #, Question Text, Status/Link */
    padding: 0.75rem 1rem;
    align-items: center;
    border-bottom: 1px solid #edf2f7;
}
body.dark-mode .review-table-header, body.dark-mode .review-table-row {
    border-bottom-color: #4a5568;
}

.review-table-header {
    background-color: #e2e8f0;
    font-weight: 700;
    color: #2d3748;
    font-size: 1.05rem; /* Slightly increased */
}
body.dark-mode .review-table-header {
    background-color: #4a5568;
    color: #e2e8f0;
}

.review-table-row {
    background-color: #ffffff;
    color: #4a5568;
    font-size: 1.00rem; /* Slightly increased */
    transition: background-color 0.2s ease;
}
body.dark-mode .review-table-row {
    background-color: #2d3748;
    color: #e2e8f0;
}
.review-table-row:hover {
    background-color: #f7fafc;
}
body.dark-mode .review-table-row:hover {
    background-color: #4a5568;
}

.review-table-row:last-child {
    border-bottom: none;
}

.review-table-cell-number {
    font-weight: 600;
}

.review-table-cell-text {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.review-table-cell-status {
    display: flex;
    justify-content: flex-end; /* Align status/link to the right */
    align-items: center;
    gap: 0.5rem;
}

/* START: Review Link as Button */
.review-link {
    display: inline-block; /* Make it behave like a block for padding/margins */
    padding: 0.4rem 0.8rem; /* Padding for button feel */
    background-color: #4f46e5; /* Indigo blue */
    color: white !important; /* Force white text */
    border-radius: 0.375rem; /* Rounded corners */
    text-decoration: none; /* Remove underline */
    font-weight: 600;
    font-size: 0.9rem; /* Slightly smaller font for button */
    border: none;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.2); /* Subtle shadow */
}
.review-link:hover {
    background-color: #4338ca; /* Darker indigo on hover */
    transform: translateY(-1px);
}
body.dark-mode .review-link {
    background-color: #6366f1; /* Lighter indigo for dark mode */
    color: #e0f2fe !important; /* Ensure light text in dark mode */
    box-shadow: 0 2px 5px rgba(99, 102, 241, 0.3);
}
body.dark-mode .review-link:hover {
    background-color: #4f46e5; /* Darker indigo on hover in dark mode */
}
/* END: Review Link as Button */


.pre-submit-review-container .confirm-submit-button {
    background-color: #ef4444; /* Red for final submit */
    color: white;
    padding: 1rem 2.5rem;
    border-radius: 0.75rem;
    font-weight: 700;
    font-size: 1.15rem; /* Slightly increased */
    transition: background-color 0.2s ease, transform 0.2s ease;
    cursor: pointer;
    border: none;
    margin-top: 2rem;
    /* Corrected shadow: from 0 44px 10px to 0 4px 10px */
    box-shadow: 0 4px 10px rgba(239, 68, 68, 0.3);
    align-self: center; /* Center the button */
}
.pre-submit-review-container .confirm-submit-button:hover {
    background-color: #dc2626; /* Darker red */
    transform: translateY(-2px);
}
.pre-submit-review-container .confirm-submit-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(239, 68, 68, 0.3);
}

/* Summary/Results Page Specific Styles */
.summary-score {
    font-size: 1.9rem; /* Slightly increased */
    font-weight: 700;
    color: #059669; /* Green for score */
    margin-bottom: 2rem;
    transition: color 0.3s ease;
    align-self: center; /* Changed from flex-start to center */
}
.summary-question-item .correct-answer {
    font-weight: 600;
    color: #059669; /* Green for correct answer */
    margin-left: 1rem;
}
.summary-question-item .user-answer-incorrect {
    font-weight: 600;
    color: #ef4444; /* Red for incorrect user answer */
    margin-left: 0.5rem;
}
.summary-question-item .status-badge {
    padding: 0.25rem 0.75rem;
    border-radius: 0.5rem;
    font-size: 0.85rem; /* Slightly increased */
    font-weight: 600;
    margin-left: 0.75rem;
    transition: background-color 0.3s ease, color 0.3s ease;
}
.status-badge.answered { background-color: #d1fae5; color: #059669; }
.status-badge.unanswered {
    background-color: transparent; /* No background highlight */
    color: #718096; /* Darker grey text */
    border: 1px solid #718096; /* Add a subtle border to define its area */
}
body.dark-mode .status-badge.unanswered {
    color: #a0aec0; /* Lighter grey text for dark mode */
}
.status-badge.flagged { background-color: #fefcbf; color: #f6e05e; }
.status-badge.correct { background-color: #d1fae5; color: #059669; }
.status-badge.incorrect { background-color: #fee2e2; color: #ef4444; }

/* New button for summary page */
.action-button-summary {
    background-color: #4f46e5; /* Indigo color */
    color: white;
    padding: 1rem 2.5rem;
    border-radius: 0.75rem;
    font-weight: 700;
    font-size: 1.15rem; /* Slightly increased */
    transition: background-color 0.2s ease, transform 0.2s ease;
    cursor: pointer;
    border: none;
    margin-top: 2rem;
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
}
.action-button-summary:hover {
    background-color: #4338ca; /* Darker indigo */
    transform: translateY(-2px);
}
.action-button-summary:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3);
}
.action-button-summary.retake {
    background-color: #f97316; /* Orange for retake */
    box-shadow: 0 4px 10px rgba(249, 115, 22, 0.3);
}
.action-button-summary.retake:hover {
    background-color: #ea580c; /* Darker orange */
}
/* Full question review item in summary */
.summary-question-item-full {
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    text-align: left; /* Align text left within the item */
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}
body.dark-mode .summary-question-item-full { /* Ensure the full question item itself is dark */
    background-color: #4a5568;
    border-color: #6366f1;
}
body.dark-mode .summary-question-item-full .question-text-full {
    font-size: 1.1rem;
    line-height: 1.6;
    color: #e2e8f0; /* White-grayish text */
    margin-bottom: 1rem;
    transition: color 0.3s ease;
}
.summary-question-item-full .options-review-list {
    margin-bottom: 1rem;
}
.summary-question-item-full .option-review {
    padding: 0.4rem 0.6rem;
    border-radius: 0.375rem;
    margin-bottom: 0.4rem;
    font-size: 1rem; /* Slightly increased */
    color: #4a5568;
    border: 1px solid transparent; /* Default transparent border */
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
body.dark-mode .summary-question-item-full .option-review { /* NEW: Ensure options within full review are dark */
    background-color: #2d3748;
    color: #e2e8f0;
    border: 1px solid #4a5568;
}
body.dark-mode .summary-question-item-full .option-review.correct-option {
    background-color: #14532d;
    border-color: #22c55e;
    color: #e0f2fe;
}
body.dark-mode .summary-question-item-full .option-review.user-chosen-incorrect {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2;
}
body.dark-mode .summary-question-item-full .explanation-box {
    background-color: #7f1d1d;
    border-color: #ef4444;
    color: #fef2f2;
}
body.dark-mode .summary-question-item-full .explanation-box strong {
    color: #fca5a5;
}
/* Styles for AI explanation */
.ai-explanation-container {
    background-color: #ecfdf5; /* Light teal */
    border: 1px solid #a7f3d0; /* Teal border */
    padding: 1rem;
    border-radius: 0.5rem;
    margin-top: 1rem;
    font-size: 0.95rem;
    color: #065f46; /* Dark teal text */
    text-align: left;
    line-height: 1.5; /* Ensure good line spacing */
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
body.dark-mode .ai-explanation-container {
    background-color: #064e3b;
    border: 1px solid #34d399; /* Teal border */
    color: #a7f3d0; /* Light teal text */
}
body.dark-mode .ai-explanation-container strong {
    color: #047857;
}
body.dark-mode .ai-explanation-container .loader {
    border-top-color: #6ee7b7;
}
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}
/* Home Page Styles */
.home-container {
    flex-grow: 1;
    display: flex;
    flex-direction: row; /* Default to row for larger screens */
    flex-wrap: wrap; /* Allow wrapping */
    justify-content: center;
    align-items: center;
    gap: 2rem;
    padding: 2rem;
    background-color: #f0f4f8;
    position: relative;
    transition: background-color 0.3s ease;
    max-width: 1200px; /* Limit max width for centering */
    margin: 1rem auto; /* Center the container */
}
body.dark-mode .home-container {
    background-color: #1a202c;
}
.home-welcome-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    flex: 1 1 45%; /* Allow it to take roughly half the width, flex-grow, flex-shrink, basis */
    min-width: 300px; /* Prevent it from becoming too narrow */
    padding: 1rem;
    box-sizing: border-box;
}
.home-container h1 {
    font-size: 3.6rem;
    font-weight: 800;
    color: #2d3748;
    margin-bottom: 0.5rem;
    transition: color 0.3s ease;
}
body.dark-mode .home-container h1 {
    color: #e2e8f0;
}
.home-container .website-name {
    font-size: 1.25rem;
    color: #718096;
    margin-bottom: 2.5rem;
    font-style: italic;
    transition: color 0.3s ease;
}
.home-container .subject-selection {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    flex: 0 1 350px; /* Adjusted flex-basis to make the box bigger */
    max-width: 405px; /* Set a more constrained max-width for the box (300 * 1.35) */
    margin-bottom: 1.5rem;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
}
body.dark-mode .subject-selection {
    background-color: #2d3748;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    border-color: #4a5568;
}
.home-container .subject-selection h3 {
    font-size: 1.8rem;
    font-weight: 700;
    color: #4a5568;
    margin-bottom: 1.5rem;
    transition: color 0.3s ease;
}
.home-container .subject-grid {
    display: flex;
    flex-direction: column; /* Keep vertical stacking */
    gap: 1rem;
    margin-bottom: 0; /* Removed bottom margin as start button is gone */
    width: 100%;
}
.home-container .subject-item {
    padding: 1rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.75rem;
    background-color: #edf2f7;
    color: #4a5568;
    font-weight: 600;
    cursor: pointer;
    opacity: 1;
    transition: all 0.2s ease, background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
    text-align: center;
}
body.dark-mode .subject-item {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
.home-container .subject-item.active-subject {
    background-color: #e0f2fe;
    border-color: #63b3ed;
    color: #2b6cb0;
    font-weight: 700;
}
body.dark-mode .subject-item.active-subject {
    background-color: #4338ca;
    border-color: #6366f1;
    color: #e0f2fe;
}
.home-container .subject-item:hover {
    background-color: #d1edfd;
}
body.dark-mode .subject-item:hover {
    background-color: #4f46e5;
}
/* Modal styles for test mode selection */
.test-mode-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: none; /* Changed from flex to none */
    justify-content: center;
    align-items: center;
    z-index: 1000;
}
.test-mode-modal-content {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 1rem;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    width: 90%;
    max-width: 400px;
    text-align: left;
    transform: translateY(-20px);
    animation: fadeInScale 0.3s ease-out forwards;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}
body.dark-mode .test-mode-modal-content {
    background-color: #2d3748;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.4);
    border-color: #4a5568;
}
@keyframes fadeInScale {
    from { opacity: 0; transform: translateY(-20px) scale(0.95); }
    to { opacity: 1; transform: translateY(0) scale(1); }
}
.test-mode-modal-content h3 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 1.5rem;
    transition: color 0.3s ease;
}
.test-mode-modal-content .test-mode-option label {
    display: block;
    padding: 1rem;
    border: 2px solid #cbd5e0;
    border-radius: 0.5rem;
    margin-bottom: 0.5rem;
    font-size: 1.1rem;
    color: #4a5568;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}
body.dark-mode .test-mode-modal-content .test-mode-option label {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
.test-mode-modal-content .test-mode-option label:hover {
    background-color: #e0f2fe;
    border-color: #93c5fd;
}
body.dark-mode .test-mode-modal-content .test-mode-option label:hover {
    background-color: #6366f1;
    border-color: #818cf8;
}
.test-mode-modal-content .test-mode-option input[type="radio"] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
}
.test-mode-modal-content .test-mode-option input[type="radio"]:checked + span {
    color: #2b6cb0;
    font-weight: 700;
}
body.dark-mode .test-mode-modal-content .test-mode-option input[type="radio"]:checked + span {
    color: #e0f2fe;
}
.test-mode-modal-content .test-mode-option input[type="radio"]:checked ~ label {
    background-color: #e0f2fe;
    border-color: #63b3ed;
}
body.dark-mode .test-mode-modal-content .test-mode-option input[type="radio"]:checked ~ label {
    background-color: #4338ca;
    border-color: #6366f1;
}
/* Separator line */
.test-mode-separator {
    border-bottom: 1px solid #cbd5e0;
    margin: 1rem 0;
    transition: border-color 0.3s ease;
}
body.dark-mode .test-mode-separator {
    border-bottom-color: #4a5568;
}

/* Theme Toggle Button */
.theme-toggle-button {
    position: absolute;
    top: 2rem; /* Adjusted top to move it down slightly from the very edge */
    right: 2rem; /* Adjusted right to move it left slightly from the very edge */
    background-color: #cbd5e0;
    color: #2d3748;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.2rem;
    cursor: pointer;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    transition: background-color 0.3s ease, color 0.3s ease, transform 0.2s ease;
    z-index: 200;
}
body.dark-mode .theme-toggle-button {
    background-color: #4a5568;
    color: #e2e8f0;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
}
.theme-toggle-button:hover {
    background-color: #a0aec0;
    transform: scale(1.05);
}
body.dark-mode .theme-toggle-button:hover {
    background-color: #6366f1;
}
/* Theme toggle icon visibility */
.theme-toggle-button .dark-mode-icon {
    display: inline-block; /* Default: show moon */
}
.theme-toggle-button .light-mode-icon {
    display: none; /* Default: hide sun */
}
body.dark-mode .theme-toggle-button .dark-mode-icon {
    display: none; /* In dark mode: hide moon */
}
body.dark-mode .theme-toggle-button .light-mode-icon {
    display: inline-block; /* In dark mode: show sun */
}

/* AI Button Styles */
.ai-button {
    background-color: #4f46e5; /* Indigo color */
    color: white;
    padding: 0.5rem 2rem; /* Adjusted padding for rectangular shape */
    border-radius: 0.75rem; /* Slightly more rounded corners for the rectangular shape */
    font-weight: 600;
    font-size: 1.1rem; /* Adjusted font size */
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3);
    display: flex; /* Use flexbox for centering text */
    justify-content: center;
    align-items: center;
    width: 150px; /* Increased width significantly */
    height: 40px; /* Decreased height significantly */
    margin-top: 2.5rem; /* Add some space from the text above */
}

body.dark-mode .ai-button {
    background-color: #6366f1; /* Lighter indigo for dark mode */
    box-shadow: 0 4px 10px rgba(99, 102, 241, 0.3);
}

.ai-button:hover {
    background-color: #4338ca; /* Darker indigo on hover */
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(79, 70, 229, 0.4);
}

body.dark-mode .ai-button:hover {
    background-color: #4f46e5; /* Darker indigo on hover in dark mode */
}

.ai-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3);
}

/* Notes Interface Button Styles (formerly notes-button) */
.notes-interface-button {
    background-color: #22c55e; /* Green color for notes */
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: 600;
    font-size: 1.1rem;
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 4px 10px rgba(34, 197, 94, 0.3);
    display: flex;
    justify-content: center;
    align-items: center;
    width: 150px;
    height: 40px;
    margin-top: 1rem; /* Space between AI and Notes button */
}

body.dark-mode .notes-interface-button {
    background-color: #16a34a; /* Darker green for dark mode */
    box-shadow: 0 4px 10px rgba(22, 163, 74, 0.3);
}

.notes-interface-button:hover {
    background-color: #15803d; /* Even darker green on hover */
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(34, 197, 94, 0.4);
}

body.dark-mode .notes-interface-button:hover {
    background-color: #14532d;
}

.notes-interface-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(34, 197, 94, 0.3);
}

/* Flashcards Button Styles */
.flashcards-interface-button {
    background-color: #f97316; /* Orange color for flashcards */
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: 600;
    font-size: 1.1rem;
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 4px 10px rgba(249, 115, 22, 0.3);
    display: flex;
    justify-content: center;
    align-items: center;
    width: 150px;
    height: 40px;
    margin-top: 1rem; /* Space between Notes and Flashcards button */
}

body.dark-mode .flashcards-interface-button {
    background-color: #ea580c; /* Darker orange for dark mode */
    box-shadow: 0 4px 10px rgba(234, 88, 12, 0.3);
}

.flashcards-interface-button:hover {
    background-color: #c2410c; /* Even darker orange on hover */
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(249, 115, 22, 0.4);
}

body.dark-mode .flashcards-interface-button:hover {
    background-color: #9a3412;
}

.flashcards-interface-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(249, 115, 22, 0.3);
}


/* Test Progress Footer */
.test-progress-footer {
    position: fixed;
    bottom: 0;
    left: 0;
    width: 100%;
    background-color: #ffffff;
    border-top: 1px solid #e2e8f0;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.05);
    padding: 0.75rem 1rem;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 0.5rem;
    overflow-x: auto;
    white-space: nowrap;
    z-index: 999;
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
}
body.dark-mode .test-progress-footer {
    background-color: #2d3748;
    border-top: 1px solid #4a5568;
    box-shadow: 0 -2px 5px rgba(0, 0, 0, 0.4);
}

.progress-box {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 30px;
    height: 30px;
    border-radius: 0.375rem;
    background-color: #f0f4f8;
    border: 1px solid #cbd5e0;
    font-size: 0.85rem;
    font-weight: 600;
    color: #4a5568;
    cursor: pointer;
    transition: background-color 0.2s ease, border-color 0.2s ease, color 0.2s ease;
    flex-shrink: 0;
}
body.dark-mode .progress-box {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}

.progress-box.answered {
    background-color: #63b3ed;
    border-color: #4299e1;
    color: white;
}
body.dark-mode .progress-box.answered {
    background-color: #4338ca;
    border-color: #6366f1;
    color: #e0f2fe;
}

.progress-box:hover {
    background-color: #a0aec0;
}
body.dark-mode .progress-box:hover {
    background-color: #6366f1;
}

/* Message Modal Styles (formerly Confirmation Modal) */
.message-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1001;
    display: none;
}
.message-modal-content {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    text-align: center;
    width: 90%;
    max-width: 350px;
    transform: scale(0.9);
    animation: fadeInScale 0.3s ease-out forwards;
}
body.dark-mode .message-modal-content {
    background-color: #2d3748;
    color: #e2e8f0;
}
.message-modal-content p {
    font-size: 1.1rem;
    margin-bottom: 1.5rem;
    color: #2d3748;
}
body.dark-mode .message-modal-content p {
    color: #e2e8f0;
}
.message-modal-buttons {
    display: flex;
    justify-content: center;
    gap: 1rem;
}
.message-modal-buttons button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    border: none;
}
.message-modal-buttons .btn-yes {
    background-color: #ef4444;
    color: white;
}
.message-modal-buttons .btn-yes:hover {
    background-color: #dc2626;
    transform: translateY(-2px);
}
.message-modal-buttons .btn-no {
    background-color: #cbd5e0;
    color: #2d3748;
}
body.dark-mode .message-modal-buttons .btn-no {
    background-color: #4a5568;
    color: #e2e8f0;
}
.message-modal-buttons .btn-no:hover {
    background-color: #6366f1;
    transform: translateY(-2px);
}

/* Unified AI Modal Styles */
.unified-ai-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1002;
}
.unified-ai-modal-content {
    background-color: #ffffff;
    padding: 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    width: 90%;
    max-width: 600px;
    height: 85vh;
    display: flex;
    flex-direction: column;
    transform: translateY(-20px);
    animation: fadeInScale 0.3s ease-out forwards;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
}
body.dark-mode .unified-ai-modal-content {
    background-color: #1a202c;
    color: #e2e8f0;
}
.unified-ai-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0;
    border-bottom: none;
}
body.dark-mode .unified-ai-modal-header {
    border-bottom-color: #4a5568;
}
.gemini-title-container {
    display: flex;
    flex-direction: column;
    align-items: flex-start;
}
.gemini-title-container span:first-child {
    font-size: 1.2rem;
    font-weight: 600;
}
.gemini-title-container .gemini-version {
    font-size: 0.8rem;
    color: #718096;
}
body.dark-mode .gemini-title-container .gemini-version {
     color: #a0aec0;
}
.user-profile-icon {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: #4f46e5;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: 600;
}
body.dark-mode .user-profile-icon {
    background-color: #6366f1;
}

.unified-ai-content {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
}

/* Chat Specific Styles (within unified modal) */
.chat-messages {
    flex-grow: 1;
    overflow-y: auto;
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
    position: relative;
}
.chat-initial-state {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 1rem;
}
.chat-initial-state h1 {
    font-size: 2.5rem;
    font-weight: 700;
    color: #4f46e5;
    margin-bottom: 2rem;
}
body.dark-mode .chat-initial-state h1 {
    color: #818cf8;
}
.suggestion-chips {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 0.75rem;
}
.suggestion-chip {
    background-color: #edf2f7;
    color: #4a5568;
    padding: 0.6rem 1rem;
    border-radius: 1rem;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s ease;
}
.suggestion-chip:hover {
    background-color: #e2e8f0;
}
body.dark-mode .suggestion-chip {
    background-color: #2d3748;
    color: #e2e8f0;
    border-color: #4a5568;
}
body.dark-mode .suggestion-chip:hover {
    background-color: #4a5568;
}
.chat-message {
    max-width: 80%;
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    font-size: 0.95rem;
    line-height: 1.4;
    transition: background-color 0.3s ease, color 0.3s ease;
}
.chat-message.user {
    align-self: flex-end;
    background-color: #4f46e5;
    color: white;
    border-bottom-right-radius: 0;
}
body.dark-mode .chat-message.user {
    background-color: #4338ca;
    color: #e0f2fe;
}
.chat-message.ai {
    align-self: flex-start;
    background-color: #edf2f7;
    color: #2d3748;
    border-bottom-left-radius: 0;
}
body.dark-mode .chat-message.ai {
    align-self: flex-start;
    background-color: #4a5568;
    color: #e2e8f0;
}
.chat-input-container-new {
    padding-top: 1rem;
}
.main-input-bar {
    display: flex;
    align-items: center;
    background-color: #edf2f7;
    border-radius: 1.5rem;
    padding: 0.25rem 0.5rem;
}
body.dark-mode .main-input-bar {
    background-color: #2d3748;
}
.chat-input-new {
    flex-grow: 1;
    border: none;
    background: transparent;
    padding: 0.75rem;
    font-size: 1rem;
    outline: none;
    color: #2d3748;
}
body.dark-mode .chat-input-new {
    color: #e2e8f0;
}
body.dark-mode .chat-input-new::placeholder {
    color: #a0aec0;
}
.input-icons {
    display: flex;
    gap: 0.25rem;
}
.secondary-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 0.25rem;
}
.icon-button-plus {
    background-color: #edf2f7;
    border: none;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    font-size: 1.5rem;
    font-weight: 300;
    color: #4a5568;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background-color 0.2s;
}
.icon-button-plus:hover {
    background-color: #e2e8f0;
}
body.dark-mode .icon-button-plus {
    background-color: #2d3748;
    color: #e2e8f0;
}
body.dark-mode .icon-button-plus:hover {
    background-color: #4a5568;
}
.action-chip {
     background-color: #edf2f7;
    color: #4a5568;
    padding: 0.5rem 1rem;
    border-radius: 1rem;
    border: 1px solid #e2e8f0;
    cursor: pointer;
    font-weight: 500;
    transition: background-color 0.2s ease;
}
.action-chip:hover {
    background-color: #e2e8f0;
}
body.dark-mode .action-chip {
    background-color: #2d3748;
    color: #e2e8f0;
    border-color: #4a5568;
}
body.dark-mode .action-chip:hover {
    background-color: #4a5568;
}


/* Notes Interface Styles */
.notes-interface-container {
    flex-grow: 1;
    margin: 1rem auto; /* Added auto for horizontal centering */
    padding: 2rem;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    display: none; /* Hidden by default */
    flex-direction: column;
    align-items: center;
    text-align: left;
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    max-width: 1000px; /* Limit max-width for better appearance on large screens */
    position: relative; /* For FAB positioning */
    /* Removed user-select properties to allow text selection */
}
body.dark-mode .notes-interface-container {
    background-color: #2d3748;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    border-color: #4a5568;
}
.notes-interface-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 700px;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid #e2e8f0;
    transition: border-color 0.3s ease;
}
body.dark-mode .notes-interface-header {
    border-bottom-color: #4a5568;
}
.notes-interface-header h2 {
    font-size: 2.6rem;
    font-weight: 800;
    color: #2d3748;
    transition: color 0.3s ease;
}

/* Notes List Container (replaces notes-content-area and notes-tab-pane) */
.notes-list-container {
    flex-grow: 1;
    overflow-y: auto;
    width: 100%;
    max-width: 700px;
    padding: 1rem 0; /* Add some vertical padding */
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* Responsive grid for cards */
    gap: 1rem; /* Space between cards */
    align-items: flex-start; /* Align cards to the top */
}

/* Individual Note Card */
.note-card {
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    transition: background-color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
    position: relative; /* For delete button positioning */
    /* Removed user-select properties to allow text selection */
}
body.dark-mode .note-card {
    background-color: #4a5568;
    border-color: #6366f1;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}

.note-card-title {
    font-size: 1.1rem;
    font-weight: 600;
    color: #2d3748;
    margin-bottom: 0.5rem;
    border: none;
    background: transparent;
    width: 100%;
    outline: none;
    resize: none; /* Prevent manual resize */
    overflow: hidden; /* Hide scrollbar */
    transition: color 0.3s ease;
}
body.dark-mode .note-card-title {
    color: #e2e8f0;
}
.note-card-title::placeholder {
    color: #a0aec0;
}

.note-card-textarea {
    flex-grow: 1;
    width: 100%;
    min-height: 80px;
    border: none;
    background: transparent;
    font-size: 0.95rem;
    line-height: 1.5;
    color: #4a5568;
    outline: none;
    resize: vertical; /* Allow vertical resize for text notes */
    transition: color 0.3s ease;
}
body.dark-mode .note-card-textarea {
    color: #e2e8f0;
}
.note-card-textarea::placeholder {
    color: #a0aec0;
}

.note-card .checklist-container {
    padding: 0; /* Override default checklist padding */
    border: none; /* Override default checklist border */
    background: transparent; /* Override default checklist background */
    margin-bottom: 0; /* Remove bottom margin */
    gap: 0.5rem; /* Smaller gap for checklist items within card */
}

.note-card .checklist-item {
    padding: 0.2rem 0; /* Smaller padding for checklist items within card */
    display: flex; /* Use flexbox for checklist items */
    align-items: center;
    gap: 0.5rem;
}
.note-card .checklist-item input[type="checkbox"] {
    flex-shrink: 0; /* Prevent checkbox from shrinking */
    transform: scale(1.1); /* Slightly larger checkbox */
    accent-color: #4f46e5;
}
.note-card .checklist-item .item-text {
    flex-grow: 1; /* Allow text to take available space */
    word-break: break-word; /* Break long words */
}
.note-card .checklist-item.completed .item-text {
    text-decoration: line-through;
    color: #718096; /* Gray out completed items */
}
body.dark-mode .note-card .checklist-item.completed .item-text {
    color: #a0aec0;
}
.note-card .checklist-item .delete-item-button {
    background: none;
    border: none;
    font-size: 1rem;
    cursor: pointer;
    color: #ef4444;
    transition: color 0.2s ease;
    flex-shrink: 0; /* Prevent button from shrinking */
}
.note-card .checklist-item .delete-item-button:hover {
    color: #dc2626;
}

.note-card .add-checklist-item-container {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.note-card .add-checklist-item-container input {
    flex-grow: 1;
    padding: 0.4rem 0.6rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.375rem;
    font-size: 0.9rem;
    outline: none;
}
body.dark-mode .note-card .add-checklist-item-container input {
    background-color: #2d3748;
    border-color: #4a5568;
    color: #e2e8f0;
}
body.dark-mode .note-card .add-checklist-item-container input::placeholder {
    color: #a0aec0;
}

.note-card .add-checklist-item-container button {
    background-color: #4f46e5;
    color: white;
    padding: 0.4rem 0.8rem;
    border-radius: 0.375rem;
    font-weight: 600;
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease;
}
body.dark-mode .note-card .add-checklist-item-container button {
    background-color: #6366f1;
}
.note-card .add-checklist-item-container button:hover {
    background-color: #4338ca;
}
body.dark-mode .note-card .add-checklist-item-container button:hover {
    background-color: #4f46e5;
}

/* New delete note button style */
.delete-note-button {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    background: none;
    border: none;
    font-size: 1.5rem;
    line-height: 1;
    color: #ef4444;
    cursor: pointer;
    padding: 0.2rem;
    border-radius: 50%;
    transition: background-color 0.2s ease, color 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 30px;
    height: 30px;
}
.delete-note-button:hover {
    background-color: rgba(239, 68, 68, 0.1);
    color: #dc2626;
}
body.dark-mode .delete-note-button {
    color: #fca5a5;
}
body.dark-mode .delete-note-button:hover {
    background-color: rgba(239, 68, 68, 0.2);
    color: #ef4444;
}


/* Floating Action Button (FAB) */
.fab-button {
    position: fixed; /* Changed to fixed for consistent positioning */
    bottom: 2rem;
    right: 2rem;
    background-color: #4f46e5; /* Indigo */
    color: white;
    border: none;
    border-radius: 50%;
    width: 56px;
    height: 56px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 2rem;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(79, 70, 229, 0.4);
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    z-index: 100; /* Ensure it's above other content */
}
body.dark-mode .fab-button {
    background-color: #6366f1;
    box-shadow: 0 4px 10px rgba(99, 102, 241, 0.5);
}
.fab-button:hover {
    background-color: #4338ca;
    transform: translateY(-2px);
    box-shadow: 0 6px 12px rgba(79, 70, 229, 0.5);
}
body.dark-mode .fab-button:hover {
    background-color: #4f46e5;
}
.fab-button:active {
    transform: translateY(0);
    box-shadow: 0 2px 5px rgba(79, 70, 229, 0.3);
}
.fab-button svg {
    width: 30px;
    height: 30px;
}

/* FAB Options Container */
.fab-options-container {
    position: fixed; /* Fixed positioning */
    bottom: calc(2rem + 56px + 1rem); /* Above FAB with some space */
    right: 2rem;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    padding: 0.5rem;
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    z-index: 101; /* Above FAB */
    transform: translateY(20px); /* Start slightly below final position */
    opacity: 0;
    pointer-events: none; /* Prevent interaction when hidden */
    transition: transform 0.2s ease-out, opacity 0.2s ease-out;
}
body.dark-mode .fab-options-container {
    background-color: #2d3748;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}
.fab-options-container.active {
    transform: translateY(0);
    opacity: 1;
    pointer-events: auto; /* Enable interaction when active */
}
.fab-option-button {
    background: none;
    border: none;
    padding: 0.75rem 1rem;
    border-radius: 0.5rem;
    text-align: left;
    font-size: 1rem;
    color: #2d3748;
    cursor: pointer;
    transition: background-color 0.2s ease, color 0.2s ease;
    display: flex; /* Use flexbox for icon and text alignment */
    align-items: center;
    gap: 8px; /* Space between icon and text */
}
body.dark-mode .fab-option-button {
    color: #e2e8f0;
}
.fab-option-button:hover {
    background-color: #edf2f7;
}
body.dark-mode .fab-option-button:hover {
    background-color: #4a5568;
}

/* Removed .save-notes-button styles and .fab-input-container */


/* Responsive adjustments */
@media (max-width: 768px) {
    .test-container, .pre-submit-review-container, .summary-container, .notes-interface-container, .flashcards-interface-container {
        flex-direction: column;
        margin: 0.5rem auto;
        padding: 1rem;
    }
    .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #e2e8f0;
        padding: 1rem;
    }
    .main-content {
        padding: 1rem;
        padding-bottom: 80px;
    }
    .header {
        flex-direction: column;
        gap: 0.5rem;
        padding: 1rem;
    }
    /* Removed .time-left responsive styles */
    .home-container {
        flex-direction: column; /* Stack vertically on small screens */
        align-items: center;
        gap: 1.5rem;
        padding: 1rem;
        max-width: 100%;
        margin: 0 auto; /* Ensure no side margins on small screens */
    }
    .home-welcome-section {
        padding: 0;
        flex: 1 1 100%; /* Take full width on small screens */
        min-width: unset; /* Remove min-width constraint */
    }
    .home-container .subject-selection {
        max-width: 100%;
        flex: 1 1 100%; /* Take full width on small screens */
        min-width: unset; /* Remove min-width constraint */
    }
    .home-container h1 {
        font-size: 2.2rem;
    }
    .home-container .website-name {
        font-size: 1rem;
    }
    .home-container .subject-grid {
        flex-direction: column; /* Ensure vertical stacking on small screens */
    }
    .subject-selection {
        padding: 1.5rem;
    }
    .subject-selection h3 {
        font-size: 1.5rem;
    }
    .subject-item {
        padding: 0.8rem;
        font-size: 0.9rem;
    }
    .theme-toggle-button {
        top: 0.75rem;
        right: 0.75rem;
        width: 35px;
        height: 35px;
        font-size: 1rem;
    }
    .unified-ai-modal-content {
        height: 90vh;
        max-width: 95%;
        padding: 1rem;
    }
    .review-table-header, .review-table-row {
        grid-template-columns: 0.5fr 2fr 1fr;
        font-size: 0.85rem;
    }
    .review-table-cell-text {
        white-space: normal;
    }
    .review-table-cell-status {
        flex-direction: column;
        align-items: flex-end;
    }
    .status-badge {
        margin-left: 0;
        margin-bottom: 0.25rem;
    }
    .question-block {
        padding: 1rem;
    }
    .question-number {
        font-size: 1.1rem;
    }
    .question-text {
        font-size: 1rem;
    }
    .options-list {
        grid-template-columns: 1fr; /* Revert to single column on smaller screens */
    }
    .options-list label {
        font-size: 0.95rem;
    }
    .options-list input[type="radio"] {
        transform: scale(1.1);
    }
    .submit-button, .confirm-submit-button, .action-button-summary, .ai-button, .notes-interface-button, .flashcards-interface-button {
        padding: 0.7rem 1.5rem;
        font-size: 1rem;
        width: auto; /* Allow buttons to shrink on mobile */
        height: auto;
    }
    .chat-message {
        font-size: 0.85rem;
        padding: 0.6rem 0.8rem;
    }
    .chat-input-container-new {
        flex-wrap: wrap;
    }
    .chat-input-new {
        flex-basis: 100%;
        margin-bottom: 0.5rem;
    }
    .notes-interface-container, .flashcards-interface-container {
        padding: 0.75rem;
    }
    .notes-interface-header h2, .flashcards-interface-header h2 {
        font-size: 1.5rem;
    }
    .notes-list-container {
        grid-template-columns: 1fr; /* Stack notes vertically on small screens */
        padding-bottom: 60px; /* Adjust for smaller FAB */
    }
    .note-card {
        padding: 0.75rem;
    }
    .note-card-title {
        font-size: 1rem;
    }
    .note-card-textarea {
        font-size: 0.9rem;
        min-height: 60px;
    }
    .checklist-item {
        padding: 0.3rem 0;
    }
    .checklist-item .item-text {
        font-size: 0.9rem;
    }
    .fab-button {
        bottom: 1rem;
        right: 1rem;
        width: 48px;
        height: 48px;
        font-size: 1.8rem;
    }
    .fab-button svg {
        width: 24px;
        height: 24px;
    }
    .fab-options-container {
        bottom: calc(1rem + 48px + 0.75rem); /* Adjust position for smaller FAB */
        right: 1rem;
        width: calc(100% - 2rem); /* Full width minus margins */
    }
    .fab-option-button {
        font-size: 0.8rem;
        padding: 0.5rem 0.7rem;
    }

    /* Flashcards specific responsive adjustments */
    .flashcard-card {
        width: 100%; /* Full width on small screens */
        height: 250px; /* Adjust height */
        font-size: 1.2rem;
    }
    .flashcard-controls {
        flex-direction: column;
        gap: 0.75rem;
    }
    .flashcard-nav-button {
        width: 100%;
    }
    .flashcard-action-button {
        width: 100%;
    }
}

/* Added basic styling for ai-response-display */
.ai-response-display {
    background-color: #f8fafc;
    border: 1px solid #e2e8f0;
    border-radius: 0.5rem;
    padding: 1rem;
    margin-top: 1rem;
    max-height: 200px; /* Limit height and make scrollable */
    overflow-y: auto;
    color: #2d3748;
    line-height: 1.5;
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}

body.dark-mode .ai-response-display {
    background-color: #2d3748;
    border-color: #4a5568;
    color: #e2e8f0;
}

/* New styles for AI loading indicator */
.ai-loading-indicator {
    display: flex;
    align-items: center;
    align-self: flex-start; /* Align with AI messages */
    padding: 0.75rem 1rem;
    border-radius: 1rem;
    border-bottom-left-radius: 0;
    background-color: #edf2f7; /* Same as AI message background */
    color: #2d3748;
    font-size: 0.95rem;
    gap: 0.5rem;
    margin-top: 0.75rem; /* Space from previous message */
    max-width: 80%;
    transition: background-color 0.3s ease, color 0.3s ease;
}

body.dark-mode .ai-loading-indicator {
    background-color: #4a5568;
    color: #e2e8f0;
}

.ai-loading-spinner {
    border: 3px solid rgba(0, 0, 0, 0.1);
    border-top: 3px solid #4f46e5; /* Indigo color for spinner */
    border-radius: 50%;
    width: 18px;
    height: 18px;
    animation: spin 1s linear infinite;
}

body.dark-mode .ai-loading-spinner {
    border-top: 3px solid #6366f1; /* Lighter indigo for dark mode spinner */
}

/* Animation for spinner */
@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Flashcard specific styles */
.flashcards-interface-container {
    flex-grow: 1;
    margin: 1rem auto;
    padding: 2rem;
    background-color: #ffffff;
    border-radius: 0.75rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
    display: none;
    flex-direction: column;
    align-items: center;
    text-align: center; /* Center content horizontally */
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    max-width: 1000px;
    position: relative;
}
body.dark-mode .flashcards-interface-container {
    background-color: #2d3748;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
    border-color: #4a5568;
}
.flashcards-interface-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    max-width: 700px;
    margin-bottom: 1.5rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid #e2e8f0;
    transition: border-color 0.3s ease;
}
body.dark-mode .flashcards-interface-header {
    border-bottom-color: #4a5568;
}
.flashcards-interface-header h2 {
    font-size: 2.6rem;
    font-weight: 800;
    color: #2d3748;
    transition: color 0.3s ease;
}

/* Flashcard Container and Flip Effect */
.flashcard-display-area {
    width: 100%;
    max-width: 500px; /* Max width for the card */
    height: 300px; /* Fixed height for consistency */
    perspective: 1000px; /* For 3D flip effect */
    margin-bottom: 2rem;
    display: flex;
    justify-content: center;
    align-items: center;
}

.flashcard-card {
    width: 100%;
    height: 100%;
    position: relative;
    transform-style: preserve-3d;
    transition: transform 0.6s;
    border-radius: 1rem;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    font-size: 1.5rem;
    font-weight: 600;
    color: #2d3748;
    text-align: center;
    padding: 1rem;
    box-sizing: border-box;
}
body.dark-mode .flashcard-card {
    background-color: #4a5568;
    border-color: #6366f1;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
}

.flashcard-card.flipped {
    transform: rotateY(180deg);
}

.flashcard-face {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 1rem;
    box-sizing: border-box;
    border-radius: 1rem; /* Match card border-radius */
    overflow: auto; /* Allow scrolling for long content */
}

.flashcard-front {
    background-color: inherit; /* Inherit from card for consistency */
    color: inherit;
}

.flashcard-back {
    background-color: inherit; /* Inherit from card */
    color: inherit;
    transform: rotateY(180deg);
}

.flashcard-content-text {
    word-break: break-word; /* Break long words */
    white-space: pre-wrap; /* Preserve whitespace and wrap text */
}

/* Flashcard Controls */
.flashcard-controls {
    display: flex;
    justify-content: center;
    gap: 1rem;
    width: 100%;
    max-width: 500px;
    margin-top: 1rem;
}

.flashcard-action-button, .flashcard-nav-button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.75rem;
    font-weight: 600;
    cursor: pointer;
    border: none;
    transition: background-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.flashcard-action-button {
    background-color: #4f46e5; /* Indigo */
    color: white;
}
body.dark-mode .flashcard-action-button {
    background-color: #6366f1;
}
.flashcard-action-button:hover {
    background-color: #4338ca;
    transform: translateY(-2px);
}
body.dark-mode .flashcard-action-button:hover {
    background-color: #4f46e5;
}

.flashcard-nav-button {
    background-color: #cbd5e0; /* Light gray */
    color: #2d3748;
}
body.dark-mode .flashcard-nav-button {
    background-color: #4a5568;
    color: #e2e8f0;
}
.flashcard-nav-button:hover {
    background-color: #a0aec0;
    transform: translateY(-2px);
}
body.dark-mode .flashcard-nav-button:hover {
    background-color: #6366f1;
}

.flashcard-count {
    font-size: 1rem;
    color: #718096;
    margin-top: 1rem;
    transition: color 0.3s ease;
}
body.dark-mode .flashcard-count {
    color: #a0aec0;
}

/* Confirmation Modal for deleting flashcards */
.confirm-modal-overlay#deleteFlashcardConfirmModal {
    z-index: 1003; /* Higher than other modals if needed */
}

/* New Flashcard Input Modal */
.new-flashcard-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1004;
}
.new-flashcard-modal-content {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-width: 450px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    transform: scale(0.9);
    animation: fadeInScale 0.3s ease-out forwards;
}
body.dark-mode .new-flashcard-modal-content {
    background-color: #2d3748;
    color: #e2e8f0;
}
.new-flashcard-modal-content h3 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 0.5rem;
    transition: color 0.3s ease;
}
body.dark-mode .new-flashcard-modal-content h3 {
    color: #e2e8f0;
}
.new-flashcard-modal-content textarea {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.5rem;
    font-size: 1rem;
    min-height: 80px;
    resize: vertical;
    outline: none;
    background-color: #f8fafc;
    color: #2d3748;
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
body.dark-mode .new-flashcard-modal-content textarea {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .new-flashcard-modal-content textarea::placeholder {
    color: #a0aec0;
}
.new-flashcard-modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    margin-top: 1rem;
}
.new-flashcard-modal-buttons button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    border: none;
}
.new-flashcard-modal-buttons .btn-cancel {
    background-color: #cbd5e0;
    color: #2d3748;
}
body.dark-mode .new-flashcard-modal-buttons .btn-cancel {
    background-color: #4a5568;
    color: #e2e8f0;
}
.new-flashcard-modal-buttons .btn-cancel:hover {
    background-color: #a0aec0;
}
body.dark-mode .new-flashcard-modal-buttons .btn-cancel:hover {
    background-color: #6366f1;
}
.new-flashcard-modal-buttons .btn-add {
    background-color: #10b981;
    color: white;
}
body.dark-mode .new-flashcard-modal-buttons .btn-add {
    background-color: #059669;
}
.new-flashcard-modal-buttons .btn-add:hover {
    background-color: #059669;
}
body.dark-mode .new-flashcard-modal-buttons .btn-add:hover {
    background-color: #14532d;
}

/* New Flashcard Folder/Set Specific Styles */
.flashcard-list-container { /* Generic container for folders or sets */
    flex-grow: 1;
    overflow-y: auto;
    width: 100%;
    max-width: 700px;
    padding: 1rem 0;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1rem;
    align-items: flex-start;
}

.flashcard-folder-item, .flashcard-set-item {
    background-color: #ffffff;
    border: 1px solid #e2e8f0;
    border-radius: 0.75rem;
    padding: 1.5rem;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}
body.dark-mode .flashcard-folder-item, body.dark-mode .flashcard-set-item {
    background-color: #4a5568;
    border-color: #6366f1;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
}
.flashcard-folder-item:hover, .flashcard-set-item:hover {
    transform: translateY(-3px);
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
}
body.dark-mode .flashcard-folder-item:hover, body.dark-mode .flashcard-set-item:hover {
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
}

.flashcard-folder-item .icon, .flashcard-set-item .icon {
    width: 60px;
    height: 60px;
    margin-bottom: 0.75rem;
    color: #4f46e5; /* Indigo color for icons */
}
body.dark-mode .flashcard-folder-item .icon, body.dark-mode .flashcard-set-item .icon {
    color: #6366f1;
}

.flashcard-folder-item .name, .flashcard-set-item .name {
    font-size: 1.2rem;
    font-weight: 600;
    color: #2d3748;
    text-align: center;
    word-break: break-word;
    transition: color 0.3s ease;
}
body.dark-mode .flashcard-folder-item .name, body.dark-mode .flashcard-set-item .name {
    color: #e2e8f0;
}

.flashcard-folder-item .subject, .flashcard-set-item .card-count {
    font-size: 0.9rem;
    color: #718096;
    margin-top: 0.25rem;
    transition: color 0.3s ease;
}
body.dark-mode .flashcard-folder-item .subject, body.dark-mode .flashcard-set-item .card-count {
    color: #a0aec0;
}

.item-options-button {
    position: absolute;
    top: 0.5rem;
    right: 0.5rem;
    background: none;
    border: none;
    cursor: pointer;
    font-size: 1.2rem;
    color: #718096;
    padding: 0.2rem;
    border-radius: 50%;
    transition: background-color 0.2s ease, color 0.2s ease;
}
.item-options-button:hover {
    background-color: #e2e8f0;
    color: #4a5568;
}
body.dark-mode .item-options-button {
    color: #a0aec0;
}
body.dark-mode .item-options-button:hover {
    background-color: #4a5568;
    color: #e2e8f0;
}

.item-options-menu {
    position: absolute;
    top: 2.5rem;
    right: 0.5rem;
    background-color: #ffffff;
    border-radius: 0.5rem;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    display: none;
    flex-direction: column;
    z-index: 10;
    min-width: 120px;
    overflow: hidden; /* Ensures rounded corners on children */
}
body.dark-mode .item-options-menu {
    background-color: #2d3748;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4);
}
.item-options-menu.active {
    display: flex;
}

.item-options-menu button {
    background: none;
    border: none;
    padding: 0.75rem 1rem;
    text-align: left;
    cursor: pointer;
    font-size: 0.95rem;
    color: #2d3748;
    transition: background-color 0.2s ease, color 0.2s ease;
}
body.dark-mode .item-options-menu button {
    color: #e2e8f0;
}
.item-options-menu button:hover {
    background-color: #edf2f7;
}
body.dark-mode .item-options-menu button:hover {
    background-color: #4a5568;
}
.item-options-menu button:not(:last-child) {
    border-bottom: 1px solid #e2e8f0;
}
body.dark-mode .item-options-menu button:not(:last-child) {
    border-bottom: 1px solid #4a5568;
}
.item-options-menu button.delete-option {
    color: #ef4444;
}
body.dark-mode .item-options-menu button.delete-option {
    color: #fca5a5;
}
.item-options-menu button.delete-option:hover {
    background-color: #fee2e2;
}
body.dark-mode .item-options-menu button.delete-option:hover {
    background-color: rgba(239, 68, 68, 0.2);
}

/* New Modal for Folder/Set Creation/Editing */
.new-item-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    display: none;
    justify-content: center;
    align-items: center;
    z-index: 1005;
}
.new-item-modal-content {
    background-color: #ffffff;
    padding: 2rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
    width: 90%;
    max-width: 450px;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    transform: scale(0.9);
    animation: fadeInScale 0.3s ease-out forwards;
}
body.dark-mode .new-item-modal-content {
    background-color: #2d3748;
    color: #e2e8f0;
}
.new-item-modal-content h3 {
    font-size: 1.5rem;
    font-weight: 700;
    color: #2d3748;
    margin-bottom: 0.5rem;
    transition: color 0.3s ease;
}
body.dark-mode .new-item-modal-content h3 {
    color: #e2e8f0;
}
.new-item-modal-content input[type="text"],
.new-item-modal-content select {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid #cbd5e0;
    border-radius: 0.5rem;
    font-size: 1rem;
    outline: none;
    background-color: #f8fafc;
    color: #2d3748;
    transition: background-color 0.3s ease, border-color 0.3s ease, color 0.3s ease;
}
body.dark-mode .new-item-modal-content input[type="text"],
body.dark-mode .new-item-modal-content select {
    background-color: #4a5568;
    border-color: #6366f1;
    color: #e2e8f0;
}
body.dark-mode .new-item-modal-content input[type="text"]::placeholder {
    color: #a0aec0;
}
.new-item-modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
    margin-top: 1rem;
}
.new-item-modal-buttons button {
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 600;
    cursor: pointer;
    transition: background-color 0.2s ease, transform 0.2s ease;
    border: none;
}
.new-item-modal-buttons .btn-cancel {
    background-color: #cbd5e0;
    color: #2d3748;
}
body.dark-mode .new-item-modal-buttons .btn-cancel {
    background-color: #4a5568;
    color: #e2e8f0;
}
.new-item-modal-buttons .btn-cancel:hover {
    background-color: #a0aec0;
}
body.dark-mode .new-item-modal-buttons .btn-cancel:hover {
    background-color: #6366f1;
}
.new-item-modal-buttons .btn-add {
    background-color: #10b981;
    color: white;
}
body.dark-mode .new-item-modal-buttons .btn-add {
    background-color: #059669;
}
.new-item-modal-buttons .btn-add:hover {
    background-color: #059669;
}
body.dark-mode .new-item-modal-buttons .btn-add:hover {
    background-color: #14532d;
}
/* Breadcrumbs for navigation */
.flashcard-breadcrumbs {
    width: 100%;
    max-width: 700px;
    text-align: left;
    margin-bottom: 1rem;
    font-size: 1rem;
    color: #718096;
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}
body.dark-mode .flashcard-breadcrumbs {
    color: #a0aec0;
}
.flashcard-breadcrumbs span {
    cursor: pointer;
    font-weight: 500;
}
.flashcard-breadcrumbs span:hover {
    text-decoration: underline;
}
.flashcard-breadcrumbs span.current {
    font-weight: 700;
    color: #2d3748;
    cursor: default;
    text-decoration: none;
}
body.dark-mode .flashcard-breadcrumbs span.current {
    color: #e2e8f0;
}
.flashcard-breadcrumbs .separator {
    color: #cbd5e0;
}
body.dark-mode .flashcard-breadcrumbs .separator {
    color: #4a5568;
}
/* Loader for flashcard content */
.flashcard-loader-container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100%;
    width: 100%;
    min-height: 200px; /* Ensure it takes up space */
    color: #4f46e5;
    font-weight: 600;
    font-size: 1.2rem;
    flex-direction: column;
    gap: 1rem;
}
.flashcard-loader {
    border: 4px solid rgba(0, 0, 0, 0.1);
    border-top: 4px solid #4f46e5;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
}
body.dark-mode .flashcard-loader {
    border-top: 4px solid #6366f1;
}
